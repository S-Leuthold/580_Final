<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Chapter 4 - Linear Regressions | ESS580 Final Project</title>
  <meta name="description" content="Chapter 5 Chapter 4 - Linear Regressions | ESS580 Final Project" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Chapter 4 - Linear Regressions | ESS580 Final Project" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Chapter 4 - Linear Regressions | ESS580 Final Project" />
  
  
  

<meta name="author" content="Sam Leuthold" />


<meta name="date" content="2022-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-3---spatial-analyses.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Leuthold Final Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface<span></span></a></li>
<li class="chapter" data-level="2" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html"><i class="fa fa-check"></i><b>2</b> Chapter 1 - Hayman Fire Recovery<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#importing-the-data-and-cleaning-it-up."><i class="fa fa-check"></i><b>2.1</b> Importing the data and cleaning it up.<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#question-1"><i class="fa fa-check"></i><b>2.2</b> Question 1<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#question-2"><i class="fa fa-check"></i><b>2.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="2.4" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#question-3"><i class="fa fa-check"></i><b>2.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#question-4"><i class="fa fa-check"></i><b>2.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="2.6" data-path="chapter-1---hayman-fire-recovery.html"><a href="chapter-1---hayman-fire-recovery.html#question-5"><i class="fa fa-check"></i><b>2.6</b> Question 5<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html"><i class="fa fa-check"></i><b>3</b> Chapter 2 - Snow Studies Analysis<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-2-1"><i class="fa fa-check"></i><b>3.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-3-1"><i class="fa fa-check"></i><b>3.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-4-1"><i class="fa fa-check"></i><b>3.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-5-1"><i class="fa fa-check"></i><b>3.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-6"><i class="fa fa-check"></i><b>3.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-7"><i class="fa fa-check"></i><b>3.7</b> Question 7<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="chapter-2---snow-studies-analysis.html"><a href="chapter-2---snow-studies-analysis.html#question-8"><i class="fa fa-check"></i><b>3.8</b> Question 8<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html"><i class="fa fa-check"></i><b>4</b> Chapter 3 - Spatial Analyses<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#importing-the-data-and-cleaning-it-up.-1"><i class="fa fa-check"></i><b>4.1</b> Importing the data and cleaning it up.<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-1-2"><i class="fa fa-check"></i><b>4.2</b> Question 1<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-2-2"><i class="fa fa-check"></i><b>4.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-3-2"><i class="fa fa-check"></i><b>4.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-4-2"><i class="fa fa-check"></i><b>4.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-5-2"><i class="fa fa-check"></i><b>4.6</b> Question 5<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-6-1"><i class="fa fa-check"></i><b>4.7</b> Question 6<span></span></a></li>
<li class="chapter" data-level="4.8" data-path="chapter-3---spatial-analyses.html"><a href="chapter-3---spatial-analyses.html#question-7-1"><i class="fa fa-check"></i><b>4.8</b> Question 7<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html"><i class="fa fa-check"></i><b>5</b> Chapter 4 - Linear Regressions<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#importing-the-data-and-cleaning-it-up.-2"><i class="fa fa-check"></i><b>5.1</b> Importing the data and cleaning it up.<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend"><i class="fa fa-check"></i><b>5.2</b> Question 1a: Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend?<span></span></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth"><i class="fa fa-check"></i><b>5.2.1</b> Question 1b: Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-2-3"><i class="fa fa-check"></i><b>5.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-3-3"><i class="fa fa-check"></i><b>5.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-4-3"><i class="fa fa-check"></i><b>5.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="chapter-4---linear-regressions.html"><a href="chapter-4---linear-regressions.html#question-5-3"><i class="fa fa-check"></i><b>5.6</b> Question 5<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESS580 Final Project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-4---linear-regressions" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Chapter 4 - Linear Regressions<a href="chapter-4---linear-regressions.html#chapter-4---linear-regressions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="importing-the-data-and-cleaning-it-up.-2" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Importing the data and cleaning it up.<a href="chapter-4---linear-regressions.html#importing-the-data-and-cleaning-it-up.-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter-4---linear-regressions.html#cb30-1" aria-hidden="true" tabindex="-1"></a>prism <span class="ot">&lt;-</span> <span class="fu">readMat</span>(<span class="st">&quot;./Data/Chapter_4/prismiowa.mat&quot;</span>)</span>
<span id="cb30-2"><a href="chapter-4---linear-regressions.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="chapter-4---linear-regressions.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(prism<span class="sc">$</span>tmaxdaily.iowa) <span class="ot">&lt;-</span> <span class="fu">list</span>(prism<span class="sc">$</span>COUNTYFP, <span class="dv">1</span><span class="sc">:</span><span class="dv">366</span>, prism<span class="sc">$</span>years)</span>
<span id="cb30-4"><a href="chapter-4---linear-regressions.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="chapter-4---linear-regressions.html#cb30-5" aria-hidden="true" tabindex="-1"></a>tmaxdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(prism<span class="sc">$</span>tmaxdaily.iowa)</span>
<span id="cb30-6"><a href="chapter-4---linear-regressions.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="chapter-4---linear-regressions.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tmaxdf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;countyfp&quot;</span>,<span class="st">&quot;doy&quot;</span>,<span class="st">&quot;year&quot;</span>,<span class="st">&quot;tmax&quot;</span>)</span>
<span id="cb30-8"><a href="chapter-4---linear-regressions.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="chapter-4---linear-regressions.html#cb30-9" aria-hidden="true" tabindex="-1"></a>tmaxdf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(tmaxdf)</span>
<span id="cb30-10"><a href="chapter-4---linear-regressions.html#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="chapter-4---linear-regressions.html#cb30-11" aria-hidden="true" tabindex="-1"></a>tmaxdf<span class="sc">$</span>doy <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(tmaxdf<span class="sc">$</span>doy)</span>
<span id="cb30-12"><a href="chapter-4---linear-regressions.html#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="chapter-4---linear-regressions.html#cb30-13" aria-hidden="true" tabindex="-1"></a>tmaxdf<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tmaxdf<span class="sc">$</span>year))</span>
<span id="cb30-14"><a href="chapter-4---linear-regressions.html#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="chapter-4---linear-regressions.html#cb30-15" aria-hidden="true" tabindex="-1"></a>winnesummer <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="chapter-4---linear-regressions.html#cb30-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(countyfp<span class="sc">==</span><span class="dv">191</span> <span class="sc">&amp;</span> doy <span class="sc">&gt;=</span> <span class="dv">152</span> <span class="sc">&amp;</span> doy <span class="sc">&lt;=</span> <span class="dv">243</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-17"><a href="chapter-4---linear-regressions.html#cb30-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="chapter-4---linear-regressions.html#cb30-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb30-19"><a href="chapter-4---linear-regressions.html#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="chapter-4---linear-regressions.html#cb30-20" aria-hidden="true" tabindex="-1"></a>winnewinter <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="chapter-4---linear-regressions.html#cb30-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(countyfp<span class="sc">==</span><span class="dv">191</span> <span class="sc">&amp;</span> (doy <span class="sc">&lt;=</span> <span class="dv">59</span> <span class="sc">|</span> doy <span class="sc">&gt;=</span> <span class="dv">335</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(tmax)) <span class="sc">%&gt;%</span></span>
<span id="cb30-22"><a href="chapter-4---linear-regressions.html#cb30-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb30-23"><a href="chapter-4---linear-regressions.html#cb30-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summarize</span>(<span class="at">meantmax =</span> <span class="fu">mean</span>(tmax))</span>
<span id="cb30-24"><a href="chapter-4---linear-regressions.html#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="chapter-4---linear-regressions.html#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="fu">nassqs_auth</span>(<span class="at">key =</span> <span class="st">&quot;11FCF4DC-1B74-3577-B8A5-5F09B27E2390&quot;</span>)</span>
<span id="cb30-26"><a href="chapter-4---linear-regressions.html#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="chapter-4---linear-regressions.html#cb30-27" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">commodity_desc =</span> <span class="st">&quot;CORN&quot;</span>, </span>
<span id="cb30-28"><a href="chapter-4---linear-regressions.html#cb30-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">util_practice_desc =</span> <span class="st">&quot;GRAIN&quot;</span>, </span>
<span id="cb30-29"><a href="chapter-4---linear-regressions.html#cb30-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">prodn_practice_desc =</span> <span class="st">&quot;ALL PRODUCTION PRACTICES&quot;</span>, </span>
<span id="cb30-30"><a href="chapter-4---linear-regressions.html#cb30-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">year__GE =</span> <span class="dv">1981</span>, </span>
<span id="cb30-31"><a href="chapter-4---linear-regressions.html#cb30-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">state_alpha =</span> <span class="st">&quot;IA&quot;</span>)</span>
<span id="cb30-32"><a href="chapter-4---linear-regressions.html#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="chapter-4---linear-regressions.html#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="chapter-4---linear-regressions.html#cb30-34" aria-hidden="true" tabindex="-1"></a>cornyieldsall <span class="ot">&lt;-</span> <span class="fu">nassqs_yields</span>(params)</span>
<span id="cb30-35"><a href="chapter-4---linear-regressions.html#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="chapter-4---linear-regressions.html#cb30-36" aria-hidden="true" tabindex="-1"></a>cornyieldsall<span class="sc">$</span>county_ansi <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cornyieldsall<span class="sc">$</span>county_ansi)</span>
<span id="cb30-37"><a href="chapter-4---linear-regressions.html#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="chapter-4---linear-regressions.html#cb30-38" aria-hidden="true" tabindex="-1"></a>cornyieldsall<span class="sc">$</span>yield <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cornyieldsall<span class="sc">$</span>Value)</span>
<span id="cb30-39"><a href="chapter-4---linear-regressions.html#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="chapter-4---linear-regressions.html#cb30-40" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">select</span>(cornyieldsall, county_ansi, county_name, yield, year) <span class="sc">%&gt;%</span></span>
<span id="cb30-41"><a href="chapter-4---linear-regressions.html#cb30-41" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(county_ansi) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(yield))</span>
<span id="cb30-42"><a href="chapter-4---linear-regressions.html#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="chapter-4---linear-regressions.html#cb30-43" aria-hidden="true" tabindex="-1"></a>cornyields <span class="ot">&lt;-</span> <span class="fu">tibble</span>(cornyields)</span></code></pre></div>
</div>
<div id="question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Question 1a: Extract Winneshiek County corn yields, fit a linear time trend, make a plot. Is there a significant time trend?<a href="chapter-4---linear-regressions.html#question-1a-extract-winneshiek-county-corn-yields-fit-a-linear-time-trend-make-a-plot.-is-there-a-significant-time-trend" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter-4---linear-regressions.html#cb31-1" aria-hidden="true" tabindex="-1"></a>winneshiek <span class="ot">&lt;-</span> cornyields <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="chapter-4---linear-regressions.html#cb31-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(county_name <span class="sc">==</span> <span class="st">&quot;WINNESHIEK&quot;</span>)</span>
<span id="cb31-3"><a href="chapter-4---linear-regressions.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="chapter-4---linear-regressions.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="chapter-4---linear-regressions.html#cb31-5" aria-hidden="true" tabindex="-1"></a>winneshiek.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> year, </span>
<span id="cb31-6"><a href="chapter-4---linear-regressions.html#cb31-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> winneshiek)</span>
<span id="cb31-7"><a href="chapter-4---linear-regressions.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="chapter-4---linear-regressions.html#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winneshiek.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ year, data = winneshiek)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -51.163  -1.841   2.363   9.437  24.376 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4763.290    448.286  -10.63 4.46e-13 ***
## year            2.457      0.224   10.96 1.77e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 16.97 on 39 degrees of freedom
## Multiple R-squared:  0.7551, Adjusted R-squared:  0.7488 
## F-statistic: 120.2 on 1 and 39 DF,  p-value: 1.767e-13</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter-4---linear-regressions.html#cb33-1" aria-hidden="true" tabindex="-1"></a>winneshiek<span class="sc">$</span>fitted.yield.lm <span class="ot">&lt;-</span> winneshiek.lm<span class="sc">$</span>fitted.values</span>
<span id="cb33-2"><a href="chapter-4---linear-regressions.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="chapter-4---linear-regressions.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="chapter-4---linear-regressions.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winneshiek) <span class="sc">+</span></span>
<span id="cb33-5"><a href="chapter-4---linear-regressions.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb33-6"><a href="chapter-4---linear-regressions.html#cb33-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb33-7"><a href="chapter-4---linear-regressions.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb33-8"><a href="chapter-4---linear-regressions.html#cb33-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> fitted.yield.lm),</span>
<span id="cb33-9"><a href="chapter-4---linear-regressions.html#cb33-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="chapter-4---linear-regressions.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="chapter-4---linear-regressions.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="chapter-4---linear-regressions.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>There is a significant time trend (p-value &lt; 0.001). Year explains ~75% of the variability in the yield data. While there are some obvious outliers (e.g., 1993), maize yield tend to increase overtime by a rate of ~2.5 bushels per acre per year.</p>
<div id="question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Question 1b: Fit a quadratic time trend (i.e., year + year^2) and make a plot. Is there evidence for slowing yield growth?<a href="chapter-4---linear-regressions.html#question-1b-fit-a-quadratic-time-trend-i.e.-year-year2-and-make-a-plot.-is-there-evidence-for-slowing-yield-growth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter-4---linear-regressions.html#cb34-1" aria-hidden="true" tabindex="-1"></a>winneshiek <span class="ot">&lt;-</span> winneshiek <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="chapter-4---linear-regressions.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year_2 =</span> year<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-3"><a href="chapter-4---linear-regressions.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="chapter-4---linear-regressions.html#cb34-4" aria-hidden="true" tabindex="-1"></a>winneshiek.qm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> year <span class="sc">+</span> year_2,</span>
<span id="cb34-5"><a href="chapter-4---linear-regressions.html#cb34-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> winneshiek)</span>
<span id="cb34-6"><a href="chapter-4---linear-regressions.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="chapter-4---linear-regressions.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winneshiek.qm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ year + year_2, data = winneshiek)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -51.384  -3.115   1.388   9.743  25.324 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  2.583e+04  8.580e+04   0.301    0.765
## year        -2.812e+01  8.576e+01  -0.328    0.745
## year_2       7.641e-03  2.143e-02   0.357    0.723
## 
## Residual standard error: 17.17 on 38 degrees of freedom
## Multiple R-squared:  0.7559, Adjusted R-squared:  0.7431 
## F-statistic: 58.84 on 2 and 38 DF,  p-value: 2.311e-12</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter-4---linear-regressions.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(winneshiek.qm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield
##           Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## year       1  34638   34638 117.5462 3.445e-13 ***
## year_2     1     37      37   0.1271    0.7234    
## Residuals 38  11198     295                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter-4---linear-regressions.html#cb38-1" aria-hidden="true" tabindex="-1"></a>winneshiek<span class="sc">$</span>fitted.yield.qm <span class="ot">&lt;-</span> winneshiek.qm<span class="sc">$</span>fitted.values</span>
<span id="cb38-2"><a href="chapter-4---linear-regressions.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="chapter-4---linear-regressions.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(winneshiek) <span class="sc">+</span></span>
<span id="cb38-4"><a href="chapter-4---linear-regressions.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb38-5"><a href="chapter-4---linear-regressions.html#cb38-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="chapter-4---linear-regressions.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb38-7"><a href="chapter-4---linear-regressions.html#cb38-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> fitted.yield.qm),</span>
<span id="cb38-8"><a href="chapter-4---linear-regressions.html#cb38-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="chapter-4---linear-regressions.html#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb38-10"><a href="chapter-4---linear-regressions.html#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="chapter-4---linear-regressions.html#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In Winnesheiek county, there is no evidence of slowing yield growth for corn. The quadratic parameter is not significant, and does not add explanatory power to the model. If anything, there has been an insignificant but noticible increase in the rate of yield growth in the decade since 2010, implying that yield growth might be increasing.</p>
</div>
</div>
<div id="question-2-3" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Question 2<a href="chapter-4---linear-regressions.html#question-2-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Time Series: Letâ€™s analyze the relationship between temperature and yields for the Winneshiek County time series. Use data on yield and summer avg Tmax. Is adding year or Tmax^2 to your model helpful? Make a plot and interpret the results.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="chapter-4---linear-regressions.html#cb39-1" aria-hidden="true" tabindex="-1"></a>winneshiek.climate <span class="ot">&lt;-</span> cornyields <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="chapter-4---linear-regressions.html#cb39-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">filter</span>(county_name <span class="sc">==</span> <span class="st">&quot;WINNESHIEK&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="chapter-4---linear-regressions.html#cb39-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">right_join</span>(., </span>
<span id="cb39-4"><a href="chapter-4---linear-regressions.html#cb39-4" aria-hidden="true" tabindex="-1"></a>                                  winnesummer, </span>
<span id="cb39-5"><a href="chapter-4---linear-regressions.html#cb39-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="st">&quot;year&quot;</span>)</span>
<span id="cb39-6"><a href="chapter-4---linear-regressions.html#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="chapter-4---linear-regressions.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="do">### Linear model</span></span>
<span id="cb39-8"><a href="chapter-4---linear-regressions.html#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="chapter-4---linear-regressions.html#cb39-9" aria-hidden="true" tabindex="-1"></a>winneshiek.climate.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax,</span>
<span id="cb39-10"><a href="chapter-4---linear-regressions.html#cb39-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> winneshiek.climate)</span>
<span id="cb39-11"><a href="chapter-4---linear-regressions.html#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="chapter-4---linear-regressions.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winneshiek.climate.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ meantmax, data = winneshiek.climate)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -71.96 -19.85  -3.19  24.64  61.72 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  275.876    118.335   2.331   0.0255 *
## meantmax      -4.763      4.438  -1.073   0.2902  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 32.88 on 36 degrees of freedom
## Multiple R-squared:  0.03101,    Adjusted R-squared:  0.004098 
## F-statistic: 1.152 on 1 and 36 DF,  p-value: 0.2902</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="chapter-4---linear-regressions.html#cb41-1" aria-hidden="true" tabindex="-1"></a>fitted.values.lm <span class="ot">&lt;-</span> winneshiek.climate.lm<span class="sc">$</span>fitted.values</span>
<span id="cb41-2"><a href="chapter-4---linear-regressions.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="chapter-4---linear-regressions.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="do">### Multiple regression</span></span>
<span id="cb41-4"><a href="chapter-4---linear-regressions.html#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="chapter-4---linear-regressions.html#cb41-5" aria-hidden="true" tabindex="-1"></a>winneshiek.climate.mlm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax <span class="sc">+</span> year,</span>
<span id="cb41-6"><a href="chapter-4---linear-regressions.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> winneshiek.climate)</span>
<span id="cb41-7"><a href="chapter-4---linear-regressions.html#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="chapter-4---linear-regressions.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winneshiek.climate.mlm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ meantmax + year, data = winneshiek.climate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -53.071  -7.269   2.271   9.935  27.505 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4791.774    513.812  -9.326 5.10e-11 ***
## meantmax       -3.201      2.308  -1.387    0.174    
## year            2.514      0.253   9.934 1.01e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 17.06 on 35 degrees of freedom
## Multiple R-squared:  0.7463, Adjusted R-squared:  0.7318 
## F-statistic: 51.48 on 2 and 35 DF,  p-value: 3.761e-11</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="chapter-4---linear-regressions.html#cb43-1" aria-hidden="true" tabindex="-1"></a>fitted.values.mlm <span class="ot">&lt;-</span> <span class="fu">predict</span>(winneshiek.climate.mlm,</span>
<span id="cb43-2"><a href="chapter-4---linear-regressions.html#cb43-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">meantmax =</span> winneshiek.climate<span class="sc">$</span>meantmax,</span>
<span id="cb43-3"><a href="chapter-4---linear-regressions.html#cb43-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">year =</span> winneshiek.climate<span class="sc">$</span>year))</span>
<span id="cb43-4"><a href="chapter-4---linear-regressions.html#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="chapter-4---linear-regressions.html#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="chapter-4---linear-regressions.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="do">### Quadratic multiple regression</span></span>
<span id="cb43-7"><a href="chapter-4---linear-regressions.html#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="chapter-4---linear-regressions.html#cb43-8" aria-hidden="true" tabindex="-1"></a>winneshiek.climate <span class="ot">&lt;-</span> winneshiek.climate <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="chapter-4---linear-regressions.html#cb43-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">tmax_2 =</span> meantmax<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb43-10"><a href="chapter-4---linear-regressions.html#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="chapter-4---linear-regressions.html#cb43-11" aria-hidden="true" tabindex="-1"></a>winneshiek.climate.mqm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> meantmax <span class="sc">+</span> tmax_2,</span>
<span id="cb43-12"><a href="chapter-4---linear-regressions.html#cb43-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> winneshiek.climate)</span>
<span id="cb43-13"><a href="chapter-4---linear-regressions.html#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="chapter-4---linear-regressions.html#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(winneshiek.climate.mqm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ meantmax + tmax_2, data = winneshiek.climate)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -56.587 -22.262  -0.982  22.409  52.798 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -4223.604   1446.639  -2.920  0.00609 **
## meantmax      328.918    107.068   3.072  0.00410 **
## tmax_2         -6.173      1.979  -3.119  0.00362 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 29.5 on 35 degrees of freedom
## Multiple R-squared:  0.2417, Adjusted R-squared:  0.1984 
## F-statistic: 5.579 on 2 and 35 DF,  p-value: 0.007887</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="chapter-4---linear-regressions.html#cb45-1" aria-hidden="true" tabindex="-1"></a>fitted.values.mqm <span class="ot">&lt;-</span> winneshiek.climate.mqm<span class="sc">$</span>fitted.values</span>
<span id="cb45-2"><a href="chapter-4---linear-regressions.html#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="chapter-4---linear-regressions.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb45-4"><a href="chapter-4---linear-regressions.html#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="chapter-4---linear-regressions.html#cb45-5" aria-hidden="true" tabindex="-1"></a>model.comparison <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Yield ~ Max Temperature&quot;</span>, <span class="at">length =</span> <span class="dv">38</span>),</span>
<span id="cb45-6"><a href="chapter-4---linear-regressions.html#cb45-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">rep</span>(<span class="st">&quot;Yield ~ Year + Max Temperature&quot;</span>, <span class="at">length =</span> <span class="dv">38</span>),</span>
<span id="cb45-7"><a href="chapter-4---linear-regressions.html#cb45-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">rep</span>(<span class="st">&quot;Yield ~ Max Temperature + Max Temperature^2&quot;</span>, <span class="at">length =</span> <span class="dv">38</span>)),</span>
<span id="cb45-8"><a href="chapter-4---linear-regressions.html#cb45-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">T_Max =</span> <span class="fu">rep</span>(winneshiek.climate<span class="sc">$</span>meantmax, <span class="dv">3</span>),</span>
<span id="cb45-9"><a href="chapter-4---linear-regressions.html#cb45-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Fitted =</span> <span class="fu">c</span>(fitted.values.lm,</span>
<span id="cb45-10"><a href="chapter-4---linear-regressions.html#cb45-10" aria-hidden="true" tabindex="-1"></a>                                      fitted.values.mlm,</span>
<span id="cb45-11"><a href="chapter-4---linear-regressions.html#cb45-11" aria-hidden="true" tabindex="-1"></a>                                      fitted.values.mqm))</span>
<span id="cb45-12"><a href="chapter-4---linear-regressions.html#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="chapter-4---linear-regressions.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb45-14"><a href="chapter-4---linear-regressions.html#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="chapter-4---linear-regressions.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> winneshiek.climate,</span>
<span id="cb45-16"><a href="chapter-4---linear-regressions.html#cb45-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> meantmax,</span>
<span id="cb45-17"><a href="chapter-4---linear-regressions.html#cb45-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb45-18"><a href="chapter-4---linear-regressions.html#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-19"><a href="chapter-4---linear-regressions.html#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> model.comparison,</span>
<span id="cb45-20"><a href="chapter-4---linear-regressions.html#cb45-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> T_Max,</span>
<span id="cb45-21"><a href="chapter-4---linear-regressions.html#cb45-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Fitted, </span>
<span id="cb45-22"><a href="chapter-4---linear-regressions.html#cb45-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Model)) <span class="sc">+</span></span>
<span id="cb45-23"><a href="chapter-4---linear-regressions.html#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb45-24"><a href="chapter-4---linear-regressions.html#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Max Temperature (C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb45-25"><a href="chapter-4---linear-regressions.html#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-26"><a href="chapter-4---linear-regressions.html#cb45-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.9</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;" />
There is a significant negative, nonlinear relationship between maximum annual temperature and average yield in Winnesheik county. This trend is best captured by the quadratic mode, which shows that yields rise to a maxima at ~27 degrees C, after which they begin to fall. Further analysis should investigate the interaction between the month during which max temperature was observed and max temerature, as corn growth stage response to temperature may confound results.</p>
<p>Adding year to the model helps to explain some of the variance, but results are significant in either case. Adding yead as a random effect in a mixed model in future analyses may provide even more robust results.</p>
</div>
<div id="question-3-3" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Question 3<a href="chapter-4---linear-regressions.html#question-3-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cross-Section: Analyze the relationship between temperature and yield across all counties in 2018. Is there a relationship? Interpret the results.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter-4---linear-regressions.html#cb46-1" aria-hidden="true" tabindex="-1"></a>climate.yield.data <span class="ot">&lt;-</span> tmaxdf <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="chapter-4---linear-regressions.html#cb46-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(doy <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">152</span>, <span class="dv">243</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="chapter-4---linear-regressions.html#cb46-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">group_by</span>(countyfp,</span>
<span id="cb46-4"><a href="chapter-4---linear-regressions.html#cb46-4" aria-hidden="true" tabindex="-1"></a>                                 year) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="chapter-4---linear-regressions.html#cb46-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">summarise</span>(<span class="at">Max_Temp =</span> <span class="fu">mean</span>(tmax, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="chapter-4---linear-regressions.html#cb46-6" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">Max_Temp2 =</span> Max_Temp<span class="sc">^</span><span class="dv">2</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="chapter-4---linear-regressions.html#cb46-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">countyfp =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>((countyfp)))) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="chapter-4---linear-regressions.html#cb46-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">left_join</span>(<span class="at">x =</span> .,</span>
<span id="cb46-9"><a href="chapter-4---linear-regressions.html#cb46-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> cornyields,</span>
<span id="cb46-10"><a href="chapter-4---linear-regressions.html#cb46-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, </span>
<span id="cb46-11"><a href="chapter-4---linear-regressions.html#cb46-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;countyfp&quot;</span> <span class="ot">=</span> <span class="st">&quot;county_ansi&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-12"><a href="chapter-4---linear-regressions.html#cb46-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(<span class="fu">is.na</span>(yield) <span class="sc">==</span> F)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;countyfp&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chapter-4---linear-regressions.html#cb48-1" aria-hidden="true" tabindex="-1"></a>state.level.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> Max_Temp <span class="sc">+</span> Max_Temp2, <span class="at">data =</span> climate.yield.data)</span>
<span id="cb48-2"><a href="chapter-4---linear-regressions.html#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="chapter-4---linear-regressions.html#cb48-3" aria-hidden="true" tabindex="-1"></a>climate.yield.data<span class="sc">$</span>Fitted <span class="ot">&lt;-</span> state.level.lm<span class="sc">$</span>fitted.values</span>
<span id="cb48-4"><a href="chapter-4---linear-regressions.html#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="chapter-4---linear-regressions.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(state.level.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ Max_Temp + Max_Temp2, data = climate.yield.data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -113.151  -21.982   -2.794   24.860   82.006 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -2098.6219   139.4315  -15.05   &lt;2e-16 ***
## Max_Temp      168.9590     9.9402   17.00   &lt;2e-16 ***
## Max_Temp2      -3.1665     0.1769  -17.90   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 31.55 on 3745 degrees of freedom
## Multiple R-squared:  0.1947, Adjusted R-squared:  0.1943 
## F-statistic: 452.8 on 2 and 3745 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapter-4---linear-regressions.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(state.level.lm)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: yield
##             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Max_Temp     1  582759  582759  585.34 &lt; 2.2e-16 ***
## Max_Temp2    1  318854  318854  320.27 &lt; 2.2e-16 ***
## Residuals 3745 3728463     996                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapter-4---linear-regressions.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> climate.yield.data,</span>
<span id="cb52-2"><a href="chapter-4---linear-regressions.html#cb52-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Max_Temp,</span>
<span id="cb52-3"><a href="chapter-4---linear-regressions.html#cb52-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb52-4"><a href="chapter-4---linear-regressions.html#cb52-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-5"><a href="chapter-4---linear-regressions.html#cb52-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> Max_Temp,</span>
<span id="cb52-6"><a href="chapter-4---linear-regressions.html#cb52-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> Fitted),</span>
<span id="cb52-7"><a href="chapter-4---linear-regressions.html#cb52-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb52-8"><a href="chapter-4---linear-regressions.html#cb52-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb52-9"><a href="chapter-4---linear-regressions.html#cb52-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb52-10"><a href="chapter-4---linear-regressions.html#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb52-11"><a href="chapter-4---linear-regressions.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Maximum Temperature (C)&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-12"><a href="chapter-4---linear-regressions.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/Question%203-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Yes, there is a significant relationship between maximum temperature and corn yields analyzed across all IA counties. When evaluated using a linear predictor, yields decline by ~ 9 bushels per acre per 1 degree increase in max temperature. However, yields decline more rapidly at higher temperatures, and as such a quadratic model is more appropriate for analyzing these data. The variability in yield (likely a function of variability in soil properties, management, and precipitation) lead to the model explaining only 19% of the variability, however the model shows significance for both the maximum temperature term, as well as the quadratic term.</p>
</div>
<div id="question-4-3" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Question 4<a href="chapter-4---linear-regressions.html#question-4-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Panel: One way to leverage multiple time series is to group all data into what is called a â€œpanelâ€ regression. Convert the county ID code (â€œcountyfpâ€ or â€œcounty_ansiâ€) into factor using as.factor, then include this variable in a regression using all countiesâ€™ yield and summer temperature data. How does the significance of your temperature coefficients (Tmax, Tmax^2) change? Make a plot comparing actual and fitted yields and interpret the results of your model.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="chapter-4---linear-regressions.html#cb53-1" aria-hidden="true" tabindex="-1"></a>climate.yield.data <span class="ot">&lt;-</span> climate.yield.data <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="chapter-4---linear-regressions.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">county_name =</span> <span class="fu">as.factor</span>(county_name))</span>
<span id="cb53-3"><a href="chapter-4---linear-regressions.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="chapter-4---linear-regressions.html#cb53-4" aria-hidden="true" tabindex="-1"></a>panel.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> Max_Temp <span class="sc">+</span> Max_Temp2 <span class="sc">+</span> county_name, <span class="at">data =</span> climate.yield.data)</span>
<span id="cb53-5"><a href="chapter-4---linear-regressions.html#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="chapter-4---linear-regressions.html#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(panel.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ Max_Temp + Max_Temp2 + county_name, data = climate.yield.data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -95.088 -21.438  -3.026  23.570  77.941 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              -2102.2327   139.2946 -15.092  &lt; 2e-16 ***
## Max_Temp                   167.9699     9.8950  16.975  &lt; 2e-16 ***
## Max_Temp2                   -3.1324     0.1758 -17.820  &lt; 2e-16 ***
## county_nameADAMS            -4.5577     7.0388  -0.648 0.517347    
## county_nameALLAMAKEE         1.9797     7.0743   0.280 0.779612    
## county_nameAPPANOOSE       -19.1369     7.0864  -2.701 0.006955 ** 
## county_nameAUDUBON           4.3024     7.0416   0.611 0.541240    
## county_nameBENTON            6.2752     7.0459   0.891 0.373195    
## county_nameBLACK HAWK        6.2028     7.0520   0.880 0.379147    
## county_nameBOONE            14.3129     7.0414   2.033 0.042157 *  
## county_nameBREMER           10.2595     7.0568   1.454 0.146076    
## county_nameBUCHANAN          6.6549     7.0596   0.943 0.345912    
## county_nameBUENA VISTA       7.5427     7.0503   1.070 0.284760    
## county_nameBUTLER            8.0045     7.0493   1.135 0.256242    
## county_nameCALHOUN           9.3627     7.0468   1.329 0.184048    
## county_nameCARROLL           8.8039     7.0426   1.250 0.211348    
## county_nameCASS              6.0858     7.0389   0.865 0.387315    
## county_nameCEDAR            14.9921     7.0443   2.128 0.033381 *  
## county_nameCERRO GORDO       3.7400     7.0668   0.529 0.596677    
## county_nameCHEROKEE         12.8689     7.0455   1.827 0.067848 .  
## county_nameCHICKASAW         1.3837     7.0714   0.196 0.844876    
## county_nameCLARKE          -24.9874     7.0863  -3.526 0.000427 ***
## county_nameCLAY              5.5213     7.0521   0.783 0.433716    
## county_nameCLAYTON           7.9986     7.0648   1.132 0.257632    
## county_nameCLINTON           9.7142     7.0455   1.379 0.168043    
## county_nameCRAWFORD          5.5829     7.0436   0.793 0.428054    
## county_nameDALLAS           10.5962     7.0391   1.505 0.132323    
## county_nameDAVIS           -14.6474     7.0887  -2.066 0.038872 *  
## county_nameDECATUR         -16.7641     7.0865  -2.366 0.018051 *  
## county_nameDELAWARE          8.6421     7.0667   1.223 0.221435    
## county_nameDES MOINES       10.8382     7.0391   1.540 0.123719    
## county_nameDICKINSON         2.0837     7.0635   0.295 0.768011    
## county_nameDUBUQUE           9.1371     7.0690   1.293 0.196245    
## county_nameEMMET             6.4115     7.0706   0.907 0.364579    
## county_nameFAYETTE           6.5576     7.0722   0.927 0.353862    
## county_nameFLOYD             3.8270     7.0595   0.542 0.587775    
## county_nameFRANKLIN         10.2572     7.0536   1.454 0.145983    
## county_nameFREMONT          15.9700     7.0526   2.264 0.023608 *  
## county_nameGREENE           14.2209     7.0396   2.020 0.043445 *  
## county_nameGRUNDY           10.3933     7.0506   1.474 0.140543    
## county_nameGUTHRIE           3.0582     7.0392   0.434 0.663988    
## county_nameHAMILTON         12.1993     7.0442   1.732 0.083392 .  
## county_nameHANCOCK           7.8892     7.0692   1.116 0.264496    
## county_nameHARDIN           13.0042     7.0463   1.846 0.065040 .  
## county_nameHARRISON          7.0324     7.0390   0.999 0.317828    
## county_nameHENRY             5.8050     7.0396   0.825 0.409641    
## county_nameHOWARD            0.9492     7.1084   0.134 0.893781    
## county_nameHUMBOLDT          8.8848     7.0596   1.259 0.208279    
## county_nameIDA              10.8610     7.0456   1.542 0.123276    
## county_nameIOWA              6.7101     7.0403   0.953 0.340600    
## county_nameJACKSON          -2.2777     7.0533  -0.323 0.746768    
## county_nameJASPER           13.8935     7.0402   1.973 0.048519 *  
## county_nameJEFFERSON         2.1063     7.0445   0.299 0.764958    
## county_nameJOHNSON           3.8916     7.0404   0.553 0.580470    
## county_nameJONES             6.8541     7.0503   0.972 0.331025    
## county_nameKEOKUK            2.4290     7.0390   0.345 0.730052    
## county_nameKOSSUTH          11.2195     7.0616   1.589 0.112188    
## county_nameLEE               3.2019     7.0439   0.455 0.649452    
## county_nameLINN              5.5167     7.0475   0.783 0.433799    
## county_nameLOUISA            8.0182     7.0400   1.139 0.254798    
## county_nameLUCAS           -23.7701     7.1360  -3.331 0.000874 ***
## county_nameLYON              8.4973     7.0446   1.206 0.227815    
## county_nameMADISON          -2.7616     7.0390  -0.392 0.694843    
## county_nameMAHASKA           8.2674     7.0389   1.175 0.240260    
## county_nameMARION            2.0919     7.0389   0.297 0.766339    
## county_nameMARSHALL         13.1465     7.0469   1.866 0.062181 .  
## county_nameMILLS             9.7388     7.1425   1.364 0.172806    
## county_nameMITCHELL          6.9486     7.0897   0.980 0.327099    
## county_nameMONONA            1.2117     7.0395   0.172 0.863346    
## county_nameMONROE          -16.6425     7.0863  -2.349 0.018900 *  
## county_nameMONTGOMERY        6.6056     7.0404   0.938 0.348183    
## county_nameMUSCATINE         8.2715     7.0389   1.175 0.240027    
## county_nameO BRIEN          13.1679     7.0506   1.868 0.061894 .  
## county_nameOSCEOLA           7.9469     7.0654   1.125 0.260765    
## county_namePAGE              0.4131     7.0406   0.059 0.953217    
## county_namePALO ALTO         6.1297     7.0527   0.869 0.384835    
## county_namePLYMOUTH          6.7353     7.0404   0.957 0.338798    
## county_namePOCAHONTAS       10.3788     7.0476   1.473 0.140925    
## county_namePOLK             14.0238     7.0389   1.992 0.046410 *  
## county_namePOTTAWATTAMIE    10.4059     7.0864   1.468 0.142075    
## county_namePOWESHIEK        10.1606     7.0397   1.443 0.149014    
## county_nameRINGGOLD        -20.5978     7.0389  -2.926 0.003451 ** 
## county_nameSAC               8.4110     7.0478   1.193 0.232778    
## county_nameSCOTT            15.5360     7.0426   2.206 0.027446 *  
## county_nameSHELBY            6.9179     7.0417   0.982 0.325957    
## county_nameSIOUX            14.7911     7.0423   2.100 0.035770 *  
## county_nameSTORY            10.2395     7.0458   1.453 0.146233    
## county_nameTAMA              8.7662     7.0459   1.244 0.213519    
## county_nameTAYLOR          -14.5056     7.0868  -2.047 0.040744 *  
## county_nameUNION           -12.5580     7.0863  -1.772 0.076452 .  
## county_nameVAN BUREN        -2.8371     7.0524  -0.402 0.687493    
## county_nameWAPELLO          -3.5740     7.0874  -0.504 0.614105    
## county_nameWARREN           -2.0199     7.0389  -0.287 0.774154    
## county_nameWASHINGTON       10.8835     7.0394   1.546 0.122169    
## county_nameWAYNE           -22.9077     7.0863  -3.233 0.001237 ** 
## county_nameWEBSTER          13.1211     7.0472   1.862 0.062700 .  
## county_nameWINNEBAGO         7.5593     7.0757   1.068 0.285441    
## county_nameWINNESHIEK        4.0826     7.0867   0.576 0.564584    
## county_nameWOODBURY          2.3508     7.0395   0.334 0.738436    
## county_nameWORTH             5.9103     7.0954   0.833 0.404908    
## county_nameWRIGHT           10.4404     7.0518   1.481 0.138817    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 30.68 on 3647 degrees of freedom
## Multiple R-squared:  0.2585, Adjusted R-squared:  0.2382 
## F-statistic: 12.71 on 100 and 3647 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="chapter-4---linear-regressions.html#cb55-1" aria-hidden="true" tabindex="-1"></a>climate.yield.data<span class="sc">$</span>fitted <span class="ot">&lt;-</span> panel.lm<span class="sc">$</span>fitted.values</span>
<span id="cb55-2"><a href="chapter-4---linear-regressions.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="chapter-4---linear-regressions.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="chapter-4---linear-regressions.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> climate.yield.data,</span>
<span id="cb55-5"><a href="chapter-4---linear-regressions.html#cb55-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> fitted,</span>
<span id="cb55-6"><a href="chapter-4---linear-regressions.html#cb55-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> yield)) <span class="sc">+</span></span>
<span id="cb55-7"><a href="chapter-4---linear-regressions.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-8"><a href="chapter-4---linear-regressions.html#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="st">&quot;Measured Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb55-9"><a href="chapter-4---linear-regressions.html#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Fitted Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb55-10"><a href="chapter-4---linear-regressions.html#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="576" style="display: block; margin: auto;" />
In the panel regression, temperature coefficents are highly significant (p-value &lt; 0.001). Including county as a factor increase the amount of variability explained by the model, and gives insight into counties where this trend is most significant. Interestingly, modeled yields tend to find a maximum at ~ 165 bu per acre, limiting the ability of the model to capture variability in high yielding counties.</p>
</div>
<div id="question-5-3" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Question 5<a href="chapter-4---linear-regressions.html#question-5-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Soybeans: Download NASS data on soybean yields and explore either a time series relationship for a given county, the cross-sectional relationship for a given year, or a panel across all counties and years.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chapter-4---linear-regressions.html#cb56-1" aria-hidden="true" tabindex="-1"></a>soybean.params <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">commodity_desc =</span> <span class="st">&quot;SOYBEANS&quot;</span>, </span>
<span id="cb56-2"><a href="chapter-4---linear-regressions.html#cb56-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">prodn_practice_desc =</span> <span class="st">&quot;ALL PRODUCTION PRACTICES&quot;</span>,</span>
<span id="cb56-3"><a href="chapter-4---linear-regressions.html#cb56-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year__GE =</span> <span class="dv">1965</span>, </span>
<span id="cb56-4"><a href="chapter-4---linear-regressions.html#cb56-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">state_alpha =</span> <span class="st">&quot;IA&quot;</span>)</span>
<span id="cb56-5"><a href="chapter-4---linear-regressions.html#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="chapter-4---linear-regressions.html#cb56-6" aria-hidden="true" tabindex="-1"></a>soybean.yields <span class="ot">&lt;-</span> <span class="fu">nassqs_yields</span>(soybean.params)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="chapter-4---linear-regressions.html#cb57-1" aria-hidden="true" tabindex="-1"></a>soybean.yields <span class="ot">&lt;-</span> soybean.yields <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="chapter-4---linear-regressions.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">Yield =</span> <span class="fu">as.numeric</span>(Value)) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="chapter-4---linear-regressions.html#cb57-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">county_ansi =</span> <span class="fu">as.numeric</span>(county_ansi)) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="chapter-4---linear-regressions.html#cb57-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(county_ansi, county_name, Yield, year) <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="chapter-4---linear-regressions.html#cb57-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(county_ansi) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(Yield)) <span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="chapter-4---linear-regressions.html#cb57-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">county_name =</span> <span class="fu">as.factor</span>(county_name)) <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="chapter-4---linear-regressions.html#cb57-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">tibble</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb57-8"><a href="chapter-4---linear-regressions.html#cb57-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">yearsq =</span> year<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-9"><a href="chapter-4---linear-regressions.html#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="chapter-4---linear-regressions.html#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="chapter-4---linear-regressions.html#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="chapter-4---linear-regressions.html#cb57-12" aria-hidden="true" tabindex="-1"></a>desmoines.lm.a <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> year <span class="sc">+</span> yearsq, <span class="at">data =</span> soybean.yields[soybean.yields<span class="sc">$</span>county_name <span class="sc">==</span> <span class="st">&quot;DES MOINES&quot;</span>,])</span>
<span id="cb57-13"><a href="chapter-4---linear-regressions.html#cb57-13" aria-hidden="true" tabindex="-1"></a>desmoines.lm.b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> year, <span class="at">data =</span> soybean.yields[soybean.yields<span class="sc">$</span>county_name <span class="sc">==</span> <span class="st">&quot;DES MOINES&quot;</span>,])</span>
<span id="cb57-14"><a href="chapter-4---linear-regressions.html#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="chapter-4---linear-regressions.html#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(desmoines.lm.a)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yield ~ year + yearsq, data = soybean.yields[soybean.yields$county_name == 
##     &quot;DES MOINES&quot;, ])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.301  -2.703   0.222   3.153   7.794 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  2.025e+04  9.651e+03   2.098   0.0406 *
## year        -2.073e+01  9.688e+00  -2.140   0.0370 *
## yearsq       5.315e-03  2.431e-03   2.186   0.0332 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.249 on 53 degrees of freedom
## Multiple R-squared:  0.7586, Adjusted R-squared:  0.7494 
## F-statistic: 83.26 on 2 and 53 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chapter-4---linear-regressions.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(desmoines.lm.b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yield ~ year, data = soybean.yields[soybean.yields$county_name == 
##     &quot;DES MOINES&quot;, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.1035  -3.4246   0.7288   3.2426   8.7950 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -846.56377   72.40675  -11.69   &lt;2e-16 ***
## year           0.44676    0.03634   12.29   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.395 on 54 degrees of freedom
## Multiple R-squared:  0.7368, Adjusted R-squared:  0.7319 
## F-statistic: 151.2 on 1 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chapter-4---linear-regressions.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> soybean.yields[soybean.yields<span class="sc">$</span>county_name <span class="sc">==</span> <span class="st">&quot;DES MOINES&quot;</span>,],</span>
<span id="cb61-2"><a href="chapter-4---linear-regressions.html#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb61-3"><a href="chapter-4---linear-regressions.html#cb61-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Yield)) <span class="sc">+</span></span>
<span id="cb61-4"><a href="chapter-4---linear-regressions.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="chapter-4---linear-regressions.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="st">&quot;Yield (bu&quot;</span><span class="sc">~</span>acre<span class="sc">^-</span><span class="dv">1</span><span class="sc">*</span><span class="st">&quot;)&quot;</span>)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="chapter-4---linear-regressions.html#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="chapter-4---linear-regressions.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>I thought it could be interesting to see if increases in technology accelerated the yield growth of soybeans in Des Moines county if we looked further back in time. The models show that this is not the case; similar to the first question, yield growth is linear for soybeans in Des Moines county. A linear model performs better than the quadratic. Part of this could be the prevalence of continuous corn in the Des Moines lobe region, but itâ€™s hard to tell without further data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-3---spatial-analyses.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Chapter_4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
